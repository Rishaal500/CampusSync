<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-500 via-indigo-600 to-purple-700 p-6">
  <div class="w-full max-w-md bg-white/20 backdrop-blur-xl rounded-2xl shadow-2xl p-8 animate-fadeIn">
    <h1 class="text-3xl font-bold text-white text-center mb-6">Student Login</h1>
    <form id="loginForm" class="space-y-5">
      <!-- Student Email -->
      <div>
        <label for="email" class="block text-sm font-medium text-white mb-1">Student Email</label>
        <input type="email" id="email" name="email" required placeholder="student@university.edu"
          class="w-full px-4 py-3 rounded-xl bg-white/30 text-white placeholder-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-300">
      </div>

      <!-- Password -->
      <div>
        <label for="password" class="block text-sm font-medium text-white mb-1">Password</label>
        <input type="password" id="password" name="password" required placeholder="********"
          class="w-full px-4 py-3 rounded-xl bg-white/30 text-white placeholder-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-300">
      </div>

      <!-- Submit Button -->
      <button type="submit"
        class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-semibold py-3 rounded-xl shadow-lg transform transition hover:scale-105 hover:from-indigo-600 hover:to-purple-700">
        Log In
      </button><br><br>
      <a href="Studentregistration.html">Dont have an account</a>

      <p id="loginStatus" class="text-center text-sm mt-4 text-white"></p>
    </form>
  </div>

  <style>
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fadeIn {
      animation: fadeIn 1s ease-out;
    }
  </style>

  <script>
    // Supabase setup
    const SUPABASE_URL = "https://gnehpyyvokyykthqnhad.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImduZWhweXl2b2t5eWt0aHFuaGFkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1NzQ0OTAsImV4cCI6MjA3MjE1MDQ5MH0.hY3tbvia4PUdNyECo4WGG_Je8SFSOfiNqrkIrWc4Vx0"; // replace with your anon key
    const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const loginForm = document.getElementById('loginForm');
    const loginStatus = document.getElementById('loginStatus');

    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const email = loginForm.email.value.trim().toLowerCase();
      const password = loginForm.password.value.trim();

      const { data, error } = await sb
        .from('students')
        .select('*')
        .eq('email', email)
        .eq('password_hash', password)
        .limit(1);
        
      if (error) {
        loginStatus.textContent = `Error: ${error.message}`;
        loginStatus.classList.add('text-red-400');
      } else if (data.length === 0) {
        loginStatus.textContent = 'Invalid email or password';
        loginStatus.classList.add('text-red-400');
      } else {
        loginStatus.textContent = 'Login successful!';
        loginStatus.classList.remove('text-red-400');
        loginStatus.classList.add('text-green-300');

        // Redirect or load dashboard here
        window.location.href = 'HomePage.html';
      }
    });
  </script>
</body>
</html>
